
create FUNCTION TANIBIRLESTIR(@KNR2 varchar(6),@SNR varchar(6)) 

RETURNS varchar(250)

AS

BEGIN

DECLARE @KNR VARCHAR(6),@ONTANI VARCHAR(250),@ID INT,@TUMU VARCHAR(255)

DECLARE CRS_PERSONEL CURSOR FOR

SELECT KNR,substring(substring(RTRIM(ONTANI),1,250)+' '+substring(RTRIM(CONVERT(VARCHAR(250),TESHISVETEDAVI)),1,250),1,250)

FROM TET_ANAMNEZ WHERE KNR=@KNR2 

AND SNR=@SNR ORDER BY KNR

OPEN CRS_PERSONEL

SET @TUMU=''

FETCH NEXT FROM CRS_PERSONEL INTO @KNR,@ONTANI

SET @ID=0

WHILE @@FETCH_STATUS =0

BEGIN

SELECT @TUMU=@TUMU+@ONTANI

SET @ID=@ID+1

IF (@ID>1) BREAK

FETCH NEXT FROM CRS_PERSONEL INTO @KNR,@ONTANI

END

CLOSE CRS_PERSONEL

DEALLOCATE CRS_PERSONEL

RETURN @TUMU

END 



